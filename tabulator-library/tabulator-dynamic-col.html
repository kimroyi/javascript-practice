<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="./vendor/tabulator.js"></script>
    <link href="./vendor/tabulator.css" rel="stylesheet">
    <script src="./vendor/jquery.min.js"></script>
    <script src="./vendor/xlsx.full.min.js"></script>
</head>

<body>
    <button id="addCol">컬럼추가</button>
    <button id="setDynamicCol">컬럼동적재구성</button>
    <button id="itemEdit">항목편집</button>
    <div style="margin-top: 10px;"></div>
    <div id="example-table"></div>

    <script>
        $(document).ready(function () {
            //define data
            const tabledata = [
                { ids: "1", name: "Billy Bob", age: 12, gender: "male", height: 95, col: "red", dob: "14/05/2010" },
                { ids: "2", name: "Jenny Jane", age: 42, gender: "female", height: 142, col: "blue", dob: "30/07/1954" },
                { ids: "3", name: "Steve McAlistaire", age: 35, gender: "male", height: 176, col: "green", dob: "04/11/1982" },
                { ids: "4", name: "Billy Bob", age: 12, gender: "male", height: 95, col: "red", dob: "14/05/2010" },
                { ids: "5", name: "Jenny Jane", age: 42, gender: "female", height: 142, col: "blue", dob: "30/07/1954" },
                { ids: "6", name: "Steve McAlistaire", age: 35, gender: "male", height: 176, col: "green", dob: "04/11/1982" },
                { ids: "7", name: "Billy Bob", age: 12, gender: "male", height: 95, col: "red", dob: "14/05/2010" },
                { ids: "8", name: "Jenny Jane", age: 42, gender: "female", height: 142, col: "blue", dob: "30/07/1954" },
                { ids: "9", name: "Steve McAlistaire", age: 35, gender: "male", height: 176, col: "green", dob: "04/11/1982" },
                { ids: "10", name: "Billy Bob", age: 12, gender: "male", height: 95, col: "red", dob: "14/05/2010" },
                { ids: "11", name: "Jenny Jane", age: 42, gender: "female", height: 142, col: "blue", dob: "30/07/1954" },
                { ids: "12", name: "Steve McAlistaire", age: 35, gender: "male", height: 176, col: "green", dob: "04/11/1982" },
            ];

            //define table
            var table = new Tabulator("#example-table", {
                data: tabledata,
                height: "500px",
                layout: "fitData",
                // renderHorizontal: "virtual",
                columns: [
                    {
                        title: "Name", field: "name", width: 300, frozen: true, editor: "input", cellClick: function (e, cell) {
                            console.log(cell);
                        }
                    },
                    { title: "age", field: "age", hozAlign: "center", sorter: "number", editor: true },
                    { title: "Gender", field: "gender", editor: "list", editorParams: { values: { "male": "Male", "female": "Female", "unknown": "Unknown" } } },
                    { title: "Height", field: "height", hozAlign: "center" },
                    { title: "Favourite Color", field: "col", hozAlign: "center" },
                    { title: "Date Of Birth", field: "dob", hozAlign: "center", sorter: "date", editor: true },
                    { title: "Driver", field: "dob", hozAlign: "center" },
                    { title: "Driver1", field: "dob", hozAlign: "center" },
                    { title: "Driver2", field: "dob", hozAlign: "center" },
                    { title: "Driver3", field: "dob", hozAlign: "center" },
                    { title: "Driver4", field: "dob", hozAlign: "center" },
                    { title: "Driver5", field: "dob", hozAlign: "center" },
                    { title: "Driver6", field: "dob", hozAlign: "center" },
                    { title: "Driver7", field: "dob", hozAlign: "center" },
                    { title: "Driver8", field: "dob", hozAlign: "center" },
                    { title: "Driver9", field: "dob", hozAlign: "center" },
                    { title: "Driver10", field: "dob", hozAlign: "center" },
                    { title: "Driver11", field: "dob", hozAlign: "center" },
                    { title: "Driver12", field: "dob", hozAlign: "center" },
                    { title: "Driver13", field: "dob", hozAlign: "center" },
                    { title: "Driver14", field: "dob", hozAlign: "center" },
                    { title: "Driver15", field: "dob", hozAlign: "center" },
                    { title: "Driver16", field: "dob", hozAlign: "center" },
                    { title: "Driver17", field: "dob", hozAlign: "center" },
                    { title: "Driver18", field: "dob", hozAlign: "center" },
                    { title: "Driver19", field: "dob", hozAlign: "center" },
                    { title: "Driver20", field: "dob", hozAlign: "center" },
                    { title: "Driver21", field: "dob", hozAlign: "center" },
                    { title: "Driver22", field: "dob", hozAlign: "center" },
                    { title: "Driver23", field: "dob", hozAlign: "center" },
                    { title: "Driver24", field: "dob", hozAlign: "center" },
                    { title: "Driver25", field: "dob", hozAlign: "center" },
                    { title: "Driver26", field: "dob", hozAlign: "center" },
                    { title: "Driver27", field: "dob", hozAlign: "center" },
                    { title: "Driver28", field: "dob", hozAlign: "center" },
                    { title: "Driver29", field: "dob", hozAlign: "center" },
                    { title: "Driver30", field: "dob", hozAlign: "center" },
                    { title: "Driver31", field: "dob", hozAlign: "center" },
                    { title: "Driver32", field: "dob", hozAlign: "center" },
                    { title: "Driver33", field: "dob", hozAlign: "center" },
                    { title: "Driver34", field: "dob", hozAlign: "center" },
                    { title: "Driver35", field: "dob", hozAlign: "center" },
                    { title: "Driver36", field: "dob", hozAlign: "center" },
                    { title: "Driver37", field: "dob", hozAlign: "center" },
                    { title: "Driver38", field: "dob", hozAlign: "center" },
                    { title: "Driver39", field: "dob", hozAlign: "center" },
                    { title: "Driver40", field: "dob", hozAlign: "center" },
                    { title: "Driver41", field: "dob", hozAlign: "center" },
                    { title: "Driver42", field: "dob", hozAlign: "center" },
                    { title: "Driver43", field: "dob", hozAlign: "center" },
                    { title: "Driver44", field: "dob", hozAlign: "center" },
                    { title: "Driver45", field: "dob", hozAlign: "center" },
                    { title: "Driver46", field: "dob", hozAlign: "center" },
                    { title: "Driver47", field: "dob", hozAlign: "center" },
                    { title: "Driver48", field: "dob", hozAlign: "center" },
                    { title: "Driver49", field: "dob", hozAlign: "center" },
                    { title: "Driver50", field: "dob", hozAlign: "center" },
                    { title: "Driver51", field: "dob", hozAlign: "center" },
                    { title: "Driver52", field: "dob", hozAlign: "center" },
                    { title: "Driver53", field: "dob", hozAlign: "center" },
                    { title: "Driver54", field: "dob", hozAlign: "center" },
                    { title: "Driver55", field: "dob", hozAlign: "center" },
                    { title: "Driver56", field: "dob", hozAlign: "center" },
                    { title: "Driver57", field: "dob", hozAlign: "center" },
                    { title: "Driver58", field: "dob", hozAlign: "center" },
                    { title: "Driver59", field: "dob", hozAlign: "center" },
                    { title: "Driver60", field: "dob", hozAlign: "center" },
                    { title: "Driver61", field: "dob", hozAlign: "center" },
                    { title: "Driver62", field: "dob", hozAlign: "center" },
                    { title: "Driver63", field: "dob", hozAlign: "center" },
                    { title: "Driver64", field: "dob", hozAlign: "center" },
                    { title: "Driver65", field: "dob", hozAlign: "center" },
                    { title: "Driver66", field: "dob", hozAlign: "center" },
                    { title: "Driver67", field: "dob", hozAlign: "center" },
                    { title: "Driver68", field: "dob", hozAlign: "center" },
                    { title: "Driver69", field: "dob", hozAlign: "center" },
                    { title: "Driver70", field: "dob", hozAlign: "center" },
                    { title: "Driver71", field: "dob", hozAlign: "center" },
                    { title: "Driver72", field: "dob", hozAlign: "center" },
                    { title: "Driver73", field: "dob", hozAlign: "center" },
                    { title: "Driver74", field: "dob", hozAlign: "center" },
                    { title: "Driver75", field: "dob", hozAlign: "center" },
                    { title: "Driver76", field: "dob", hozAlign: "center" },
                    { title: "Driver77", field: "dob", hozAlign: "center" },
                    { title: "Driver78", field: "dob", hozAlign: "center" },
                    { title: "Driver79", field: "dob", hozAlign: "center" },
                    { title: "Driver80", field: "dob", hozAlign: "center" },
                    { title: "Driver81", field: "dob", hozAlign: "center" },
                    { title: "Driver82", field: "dob", hozAlign: "center" },
                    { title: "Driver83", field: "dob", hozAlign: "center" },
                    { title: "Driver84", field: "dob", hozAlign: "center" },
                    { title: "Driver85", field: "dob", hozAlign: "center" },
                    { title: "Driver86", field: "dob", hozAlign: "center" },
                    { title: "Driver87", field: "dob", hozAlign: "center" },
                    { title: "Driver88", field: "dob", hozAlign: "center" },
                    { title: "Driver89", field: "dob", hozAlign: "center" },
                    { title: "Driver90", field: "dob", hozAlign: "center" },
                    { title: "Driver91", field: "dob", hozAlign: "center" },
                    { title: "Driver92", field: "dob", hozAlign: "center" },
                ],
            });

            const addCol = document.getElementById('addCol');

            addCol.addEventListener('click', () => {
                table.addColumn({ title: "dynamicCol", field: "dob" }, true, "addCol");
            });

            const setDynamicCol = document.getElementById('setDynamicCol');

            setDynamicCol.addEventListener('click', () => {
                const newColumns = [
                    { title: "Driver1", field: "dob", hozAlign: "center" },
                    { title: "Driver2", field: "dob", hozAlign: "center" },
                    { title: "Driver3", field: "dob", hozAlign: "center" },
                    { title: "Driver4", field: "dob", hozAlign: "center" },
                    { title: "Driver5", field: "dob", hozAlign: "center" },
                ]

                table.setColumns(newColumns);

                const tabledata = [
                    { dob: "t1" },
                    { dob: "t2" },
                    { dob: "t3" },
                    { dob: "t4" },
                    { dob: "t5" },
                ];
                table.setData(tabledata);
            });
        });
    </script>
</body>

</html>